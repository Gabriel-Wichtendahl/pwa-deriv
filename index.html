<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Deriv Signals</title>

  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#020617" />

  <link rel="stylesheet" href="style.css" />
</head>

<body class="neon">
  <div class="bgNeon" aria-hidden="true"></div>

  <header class="header">
    <h2 id="status" class="status">Conectandoâ€¦</h2>

    <div class="topStatus">
      <div id="tickHealth" class="pill">Ãšltimo tick: â€”</div>

      <div id="countdown" class="pill countdownPill" aria-label="Cuenta regresiva del minuto">
        <span id="countdownText" class="countText">â±ï¸ 60</span>
      </div>
    </div>

    <div class="tabsBar">
      <div class="tabs" role="tablist" aria-label="Secciones">
        <button class="tab active" type="button" data-view="signals" role="tab" aria-selected="true">SeÃ±ales</button>
        <button class="tab" type="button" data-view="feedback" role="tab" aria-selected="false">Feedback</button>
      </div>
      <button id="configBtn" class="tabIcon" type="button" aria-label="ConfiguraciÃ³n">âš™ï¸</button>
    </div>

    <div id="counter" class="counter">SeÃ±ales: 0</div>
    <div id="hitCounter" class="counter">âœ… Aciertos: 0</div>
  </header>

  <main class="main">
    <section id="signalsView">
      <div id="signals" class="signals"></div>
    </section>

    <section id="feedbackView" class="feedback hidden">
      <h3 class="h3">Feedback</h3>
      <textarea id="feedback" rows="6"></textarea><br />
      <button id="copyFeedback" class="btn btnGhost" type="button">ğŸ“‹ Copiar feedback</button>
    </section>
  </main>

  <audio id="alertSound" src="alert.mp3" preload="auto"></audio>

  <!-- âœ… Modal grÃ¡fico (LIVE + trade row) -->
  <div id="chartModal" class="modal hidden" aria-hidden="true">
    <div id="modalCloseBackdrop" class="modalBackdrop"></div>

    <div class="modalCard" role="dialog" aria-modal="true">
      <div class="modalHeader">
        <div>
          <div id="modalTitle" class="modalTitle">GrÃ¡fico</div>
          <div id="modalSub" class="modalSub">â€”</div>
        </div>
        <button id="modalCloseBtn" class="btnIcon" type="button" aria-label="Cerrar">âœ–</button>
      </div>

      <canvas id="minuteCanvas"></canvas>

      <div class="modalFooter">
        <div class="tradeRow">
          <button id="modalBuyCallBtn" class="btn" type="button">ğŸŸ¢ COMPRAR</button>
          <button id="modalBuyPutBtn" class="btn" type="button">ğŸ”´ VENDER</button>
          <button id="modalLiveBtn" class="btn btnGhost" type="button" aria-pressed="false" title="LIVE del minuto actual">
            ğŸŸ¦ LIVE OFF
          </button>
        </div>

        <div class="tradeRow">
          <button id="modalOpenDerivBtn" class="btn btnPrimary" type="button">Abrir Deriv</button>
        </div>
      </div>
    </div>
  </div>

  <!-- âœ… Modal configuraciÃ³n (token + moneda + stake) -->
  <div id="settingsModal" class="modal hidden" aria-hidden="true">
    <div id="settingsCloseBackdrop" class="modalBackdrop"></div>

    <div class="modalCard modalCardSmall" role="dialog" aria-modal="true">
      <div class="modalHeader">
        <div>
          <div class="modalTitle">ConfiguraciÃ³n</div>
          <div class="modalSub">Preferencias, token y modo</div>
        </div>
        <button id="settingsCloseBtn" class="btnIcon" type="button" aria-label="Cerrar">âœ–</button>
      </div>

      <div class="settingsBody">
        <div class="controls">
          <button id="soundBtn" class="btn" type="button">ğŸ”‡ Sonido OFF</button>
          <button id="vibrateBtn" class="btn" type="button">ğŸ“³ VibraciÃ³n ON</button>
          <button id="wakeBtn" class="btn" type="button">ğŸ”“ Pantalla activa</button>
          <button id="themeBtn" class="btn" type="button">ğŸŒ™ Oscuro</button>

          <div class="btnGroup" aria-label="Segundo de evaluaciÃ³n">
            <button class="btn evalBtn" type="button" data-sec="45">â±ï¸ 45s</button>
            <button class="btn evalBtn" type="button" data-sec="50">â±ï¸ 50s</button>
            <button class="btn evalBtn" type="button" data-sec="55">â±ï¸ 55s</button>
          </div>

          <button id="modeBtn" class="btn modeBtn" type="button">ğŸŸ¦ Modo NORMAL</button>

          <!-- âœ… Token + moneda + stake -->
          <div class="configGrid" style="grid-column: 1 / -1;">
            <label class="cfgLabel" for="tokenInput">Token DEMO (Read + Trade)</label>
            <input id="tokenInput" class="cfgInput" type="password" placeholder="PegÃ¡ tu token acÃ¡â€¦" autocomplete="off" />
            <div class="cfgRow">
              <button id="saveTokenBtn" class="btn btnGhost" type="button">ğŸ’¾ Guardar token</button>
              <button id="clearTokenBtn" class="btn btnGhost" type="button">ğŸ—‘ï¸ Borrar token</button>
            </div>

            <div class="cfgRow">
              <div class="cfgCol">
                <label class="cfgLabel" for="currencySelect">Moneda DEMO</label>
                <select id="currencySelect" class="cfgSelect">
                  <option value="USD">USD</option>
                  <option value="EUR">EUR</option>
                  <option value="GBP">GBP</option>
                  <option value="AUD">AUD</option>
                </select>
              </div>

              <div class="cfgCol">
                <label class="cfgLabel" for="stakeInput">Stake</label>
                <input id="stakeInput" class="cfgInput" type="number" min="0.35" step="0.01" placeholder="1.00" />
              </div>
            </div>

            <button id="checkBalanceBtn" class="btn btnGhost" type="button">ğŸ’° Ver saldo (API)</button>
          </div>

          <button id="clearHistoryBtn" class="btn btnDanger" type="button">ğŸ§¹ Vaciar historial</button>
          <button id="resetCacheBtn" class="btn btnGhost" type="button">ğŸ§¹ Reset Cache/SW</button>
          <button id="exportVotedBtn" class="btn btnGhost" type="button">ğŸ“¤ Exportar (solo con voto)</button>
          <button id="lowPowerBtn" class="btn btnGhost" type="button">ğŸ”‹ Bajo consumo OFF</button>
        </div>

        <div class="modalFooter" style="margin-top:10px">
          <button id="settingsCloseBtn2" class="btn btnGhost" type="button">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>

  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js");
    }
  </script>
</body>
</html>